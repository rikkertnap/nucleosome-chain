# srcf90-fdis5-planar


## Description-branch develop-3D

Uses the molecular theory approach to compute the structure of a weak polyelectrolyte layer end-tethered to one or two opposing planar surfaces in 3D (cartesian and oblique) coordinates. The aqueous solution is characterized by pH, NaCl, and Ca2Cl.
Formation of Ca-bridges between polyelectrolyte monomer is taken into account. Surfaces can have various type of charged or chargeable groups. Namely the surface charge model can represent a constant charge, mineral surfaces (quartz, clay, or calcite) or a functional group of taurine.


### Prerequisites

The program uses the kinsol solver form the library package sundials.
Sundials/kinsol, version 2.

### Installing

Modify Makefile such that in contains the appropriate linker flags to the sundials library.
Linker flags can be obtained form the examples directory of the sundials installation.



### Running

The program uses an input file called 'input.in' that contain following key words.


| Keyword (type)     	    | Description                       | Value                                                |
| ------------------------|-----------------------------------|------------------------------------------------------|
| method `char`		        | Selects solver KINSOL		            | __KINSOL__                                           |
| chainmethod `char` 	    | Selects method of chain generation  | __MC__: conformation generated by Monte Carlo        |
|    	            	      |                                     | __FILE_TXT__: conformations from txt-format file     |
|    	                    |                                     | __FILE_lammps_XYZ__ : conformations from lammps-format file: traj<rank>.xyz |
|                         |                                     | __FILE_lammps_TRAJ__: conformations from lammps-format file: traj<rank>.lammpstrj'|
| chaintype `char`        | Sets sequence of A and B monomers in  chain. | __diblock__: diblock copolymer A-block-B chain length A block set by Keyword `chainperiod` |     
| 	                      | 	                                           | __altA__: alternating copolymer A-alt-B mod(s,chainperiod)!=0 is A monomer|
|			                    |                                              | __altB__: alternating copolymer B-alt-A mod(s,chainperiod)=0 is A monomer |
|		                      |                                              | __copoly__: Sequence read in from sequence.in not implemented yet|
| systype  `char`         | Sets the type of system		| __elect__: weak polyacid no VdW interaction single surface tethered|
|                         |                       		| __neutral__:  neutral polymer plus VdW interaction |
|                         |                       		| __neutralnoVdW__:  neutral polymer no VdW interaction |
|                         |                           | __brush_mul__: multi-component acid-base: VdW interaction |
|                         |                           | __brush_mulnoVdW__: multi-component acid-base: noVdW interaction  |
|                         |                           | __brushborn__ : idem brush plus varing Born Energy  |
|                         |                           | __brushssdna__  : multi-component acid-base plus one acid with Ca/Mg binding |
|runtype`char`             | Sets type of run                  | __inputcspH__ : loop over pH salt concentration from file salt.in|
|                          |   	                               | __inputMgpH__ : loop over pH Mg salt concentration from file saltMg.in |
|                          |   	                               | __rangedist__ : loop over distance between plates  |
|                          |   	                               | __rangecpro__ : loop over protein concentrations   |
|                          |                                   | __rangepKd__: loop over pKd2 Mg salt concentration  from file saltMg.in |   
|                          |                                   | __rangeVweps__: loop over VdWScale VdW parameters |   
|bcflag(RIGHT) `char`	| Sets type of boundary condition for RIGHT surface  |__qu__: quartz |
|	                    | |__cl__: clay  |
|	                    | |__ca__: calcite |
|			                | |__ta__: taurine=AMPS  |		
|                     | |__cc__: constant charge |
|bcflag(LEFT) `char`   | Sets type of boundary condition for LEFT surface |__ta__: taurine  |
|	                     |                                                  |__cc__: constant charge |
|isChainEnergyFile `logical` |                                    | __True__ reads traj<rank>.ene containing energy of conformation read from file |
|                          |                                      | __False__                              |
|isEnergyshitFile `logical` |                                     | not used |
|tolerance `real`			  	| Expectation tolerance, maximal error non-linear solver||  
|infile `int`		        |        Select initial guess for non-linear solver |__0__:  homogenous guess initial guess |
|		                    |                                      |__1__: read guess from a input file |
|pH%val `real`            |    pH value    ||
|pH%min `real`			      |  Minimal pH value||
|pH%max `real`	          |  Maximum pH value||
|pH%stepsize `real`       |  Stepsize pH value ||
|pH%delta `real`          |     Minimal allowed stepsize. Stopping criteria||
|KionNa `real`            | dissociation constant of NaCl| __0__  complete dissociation|
|   	                    |                              | __0.60__ : suggested value for NaCl|
|KionK `real`						  | dissociation constant of KCl | |
|sigmaSurfL `real`	      | Surface charge density LEFT surface Unit: e/nm2, only for bcflag(LEFT)==cc  | not read in |
|sigmaSurfR `real`		    | Surface charge density RIGHT surfcae Unit: e/nm2, only for bcflag(RIGHT)==cc | not read in |
|cNaCl `real`              | NaCl value     |  |
|cKCl `real`               | KCl value      |  |
|cRbCl `real`              | RbCl value     |   | 
|cCaCl2 `real`             | CaCl2 value    |   |
|cMgCl2 `real`             | MgCl2 value    |   |
|cpro%val `real`            |  cpro value protein concentration    ||
|cpro%min `real`			      |  Minimal cpro value||
|cpro%max `real`	          |  Maximum cpro value||
|cpro%stepsize `real`       |  Stepsize cpro value ||
|cpro%delta `real`          |     Minimal allowed stepsize. Stopping criteria|| 
|Rpro`real`                 |  radius protein||  
|nsize `int` 		           | System size or number of lattice site nsize=nx ny nz ||
|nseg  `int`		           | Number of segments  copolymer      ||
|nsegtypes `int`           | Number of segments types          ||
|maxnchains   `int`        | maximum Euler rotation chain conformation | __12__: default if not set *|
|maxnchainsxy  `int`       | maximum Euler rotation chain conformation in xy plane | __1__: default if not set * | 
|                          |                                                       |  * dependent of chainmethod  |
|cuantas `int`             | Number of copolymer conformations ||
|chainperiod `int`         | set length diblock or alternating polymer,| |  
|                          | works together with chaintype.            | |  
|vpolfname `char`          | name file containing segment volume of all types ||
|typesfname `char`         | name file containing list of all types ||
|pKafname `char`           | name file containing pKa and charge of all types ||
|lsegfname `char`          | name file containing segment lenght of all types ||
|nx `int`                 | number of lattice cells in x-direction. Unit: delta ||
|ny `int`                 | number of lattice cells in y-direction. Unit: delta || 
|nzmax `int`		          | maximum separation surfaces Unit: delta ||
|nzmin `int`			        | minimal separation opposing surfaces Unit: delta ||
|nzstep `int`					    | unit stepsize by which distance between surface is reduce Unit: delta ||
|ngr_freq `int`           | controls number of graft points ngr=int(nx/ngr_freq)*int(ny/ngr_freq)  ||
|verboseflag `char`			  | Regulates verbosity of output files |__yes__: all density outputted|
|                         |                                     | __no__: density of all ions omitted|
|delta `int`			        | Lattice size      Unit: nm           ||
|unit_conv `real`			    | Scaling if segement length conformatiom       ||
|                         | are read from  FILE read in   ||  
|geometry `char`          | set geometry or shape of lattice  | __cubic__ : Cartesian lattice |
|                         |                                   | __prism__ : oblique lattice   |
|sgraft `int`             | segment number of graft | only used chaintype equal loop | 
|nset_per_graft `int`     | number of graft | only used chaintype equal loop | 
|gamma `real`             | angle between the none-orthogonal prism basis vectors, unit: radian | |
| isRandom_pos_graft `logical`  | Displaces  grafting position by a random distance | .false. : regular |
|                               |                         | .true. : irregular|
|seed_graft 'int'              | Seed for graft point. use in combination with isRandom_pos_graft | |
|                              | Different values produce different random patterns|  | 
| write_mc_chain `logical`          | if .true. writes MC chain to file  ||  
|precondition `logical`    | if precondition==".true."  precondition | __.false.__ : default if not set |
|dielect_env `char`        | Selects the dielect function                         | __linear__ |
|                          | only used for systype="brushvarelec" and "brushborn" | __constant__ |
|                          |                                                      | __MaxwellGarnett__ |     
|  | Following variables describe VdW interactions. | |
|VdWeps%val `real`	          | Strength VdW parameter 	Unit: kBT    |  |
|VdWeps%min `real`			      | Minimum strength VdW parameter  Unit: kBT    |  |
|VdWeps%max `real`			      | Maximum strength VdW parameter  Unit: kBT    | - |
|VdWeps%stepsize `real`			  | Stepsize strength VdW parameter     Unit: kBT  | - |
|VdWeps%delta `real`			    | Minimal allowed stepsize. Stopping criteria  Unit: kBT    | - |
|pKd%val `real`	              | Strength pKd parameter 	    |  |
|pKd%min `real`			          | Minimum strength pKd parameter    |  |
|pKd%max `real`			          | Maximum strength pKd parameter      | - |
|pKd%stepsize `real`			    | Stepsize strength pKd parameter     | - |
|pKd%delta `real`			        | Minimal allowed stepsize. Stopping criteria    | - |

## Built With

* [Sundials](https://computation.llnl.gov/projects/sundials/)


## Versioning

version 1.3.1 06-10-2021

## Authors

* **Rikkert J Nap**
